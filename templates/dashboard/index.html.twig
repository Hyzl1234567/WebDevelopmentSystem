 {% extends 'dashboard/layout.html.twig' %}

{% block title %}Dashboard{% endblock %}

{% block body %}
<style>
/* --- Dashboard Summary Cards --- */
.dashboard-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-bottom: 40px;
}

.card {
  background: #fff;
  border-radius: 16px;
  padding: 20px;
  text-align: center;
  box-shadow: 0 3px 8px rgba(0,0,0,0.1);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  height: 140px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 6px 16px rgba(0,0,0,0.1);
}

.card i {
  font-size: 28px;
  margin-bottom: 10px;
}

.card h3 {
  font-size: 16px;
  margin: 5px 0;
  color: #333;
}

.card p {
  font-size: 24px;
  font-weight: bold;
  margin: 5px 0;
  color: #2d4d22;
}


.card.green { border-left: 6px solid #2d572c; }
.card.orange { border-left: 6px solid #ff9f1c; }
.card.red { border-left: 6px solid #d62828; }
.card.blue { border-left: 6px solid #007bff; }
.card.purple { border-left: 6px solid #6f42c1; }
.card.teal { border-left: 6px solid #20c997; }

.card a {
  text-decoration: none;
  color: inherit;
  display: block;
  height: 100%;
}

/* --- Recent Activities --- */
.activities-section {
  background: #fff;
  border-radius: 16px;
  padding: 25px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.1);
  margin-bottom: 40px;
}

.activities-section h2 {
  color: #2d4d22;
  margin-bottom: 20px;
  border-bottom: 2px solid #99CC67;
  padding-bottom: 10px;
}

.activity-item {
  display: flex;
  align-items: start;
  padding: 12px;
  border-bottom: 1px solid #eee;
  transition: background 0.2s;
}

.activity-item:hover {
  background: #f8f9fa;
}

.activity-item:last-child {
  border-bottom: none;
}

.activity-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 15px;
  flex-shrink: 0;
}

.activity-icon.create { background: #d4edda; color: #155724; }
.activity-icon.update { background: #fff3cd; color: #856404; }
.activity-icon.delete { background: #f8d7da; color: #721c24; }
.activity-icon.login { background: #cfe2ff; color: #084298; }

.activity-content {
  flex: 1;
}

.activity-user {
  font-weight: 600;
  color: #2d4d22;
}

.activity-description {
  color: #666;
  font-size: 14px;
  margin: 3px 0;
}

.activity-time {
  font-size: 12px;
  color: #999;
}

/* --- Category Cards --- */
.category-card {
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.1);
  text-align: center;
  padding: 15px;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  height: 140px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  border-left: 6px solid #2d572c;
}

.category-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 6px 16px rgba(0,0,0,0.1);
}

.category-img {
  width: 60px;
  height: 60px;
  object-fit: cover;
  border-radius: 8px;
  margin: 0 auto 10px auto;
}

.category-title {
  font-weight: 600;
  font-size: 1rem;
  margin: 0;
}

.category-text {
  font-size: 0.85rem;
  color: #6c757d;
  margin-top: 4px;
}

.category-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 20px;
}
</style>

<div class="container mt-5">
  <h1 class="mb-4 text-center fw-bold">Dashboard Overview</h1>

  <!-- Dashboard Stats -->
  <div class="dashboard-cards mb-5">
    <div class="card green">
      <i class="fas fa-users"></i>
      <h3>Total Users</h3>
      <p>{{ totalUsers }}</p>
    </div>
    <div class="card purple">
      <i class="fas fa-user-shield"></i>
      <h3>Total Admins</h3>
      <p>{{ totalAdmins }}</p>
    </div>
    <div class="card teal">
      <i class="fas fa-user-tie"></i>
      <h3>Total Staff</h3>
      <p>{{ totalStaff }}</p>
    </div>
    <div class="card orange">
      <i class="fas fa-mug-hot"></i>
      <h3>Total Products</h3>
      <p>{{ totalProducts }}</p>
    </div>
    <div class="card blue">
      <i class="fas fa-tags"></i>
      <h3>Categories</h3>
      <p>{{ totalCategories }}</p>
    </div>
    <div class="card red">
      <i class="fas fa-boxes"></i>
      <h3>Stock Items</h3>
      <p>{{ totalStocks }}</p>
    </div>
    <div class="card purple">
  <i class="fas fa-database"></i>
  <h3>Total Records</h3>
  <p>{{ totalRecords }}</p>
</div>
    <div class="card blue">
      <a href="/admin/users/">
        <i class="fas fa-users-cog"></i>
        <h3>Manage Users</h3>
        <p>Click to manage</p>
      </a>
    </div>
  </div>

  <!-- Recent Activities -->
  <div class="activities-section">
    <h2><i class="fas fa-history"></i> Recent Activities</h2>
    {% if recentActivities|length > 0 %}
      {% for activity in recentActivities %}
        <div class="activity-item">
          <div class="activity-icon {{ activity.action|lower }}">
            {% if activity.action == 'create' %}
              <i class="fas fa-plus"></i>
            {% elseif activity.action == 'update' %}
              <i class="fas fa-edit"></i>
            {% elseif activity.action == 'delete' %}
              <i class="fas fa-trash"></i>
            {% elseif activity.action == 'login' %}
              <i class="fas fa-sign-in-alt"></i>
            {% else %}
              <i class="fas fa-info"></i>
            {% endif %}
          </div>
          <div class="activity-content">
            <div class="activity-user">
              {{ activity.user ? activity.user.username : 'System' }}
            </div>
            <div class="activity-description">
              {{ activity.description ?? (activity.action ~ ' ' ~ activity.entity ~ ' #' ~ activity.entityId) }}
            </div>
            <div class="activity-time">
              {{ activity.createdAt|date('Y-m-d H:i:s') }}
            </div>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p style="text-align: center; color: #999; padding: 20px;">No recent activities</p>
    {% endif %}
  </div>

  <!-- Product Categories -->
  <h2 class="mb-4 text-center fw-bold">Product Categories</h2>
  <div class="category-grid">
    {% for category in categories %}
      <div class="category-card">
        <img src="{{ asset('image/' ~ category.image) }}" alt="{{ category.name }}" class="category-img">
        <h5 class="category-title">{{ category.name }}</h5>
        <p class="category-text">{{ category.description }}</p>
      </div>
    {% endfor %}
  </div>
</div>

{% endblock %}